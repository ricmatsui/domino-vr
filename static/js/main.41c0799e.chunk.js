(this["webpackJsonpdomino-vr"]=this["webpackJsonpdomino-vr"]||[]).push([[0],{142:function(e,t,n){},143:function(e,t,n){},255:function(e,t,n){"use strict";n.r(t);var r=n(14),o=n(0),c=n.n(o),a=n(62),i=n.n(a),u=(n(142),n(18)),s=n(12),l=n(9),j=(n(143),n(74)),b=n(73),d=n(262),p=n(256),O=n(72),m=n.n(O),x=n(1),h=n(23),f=[.375,.75,.075],g=new x.Vector3(0,.05,-.05),S=function(){var e=c.a.useState([]),t=Object(l.a)(e,2),n=t[0],o=t[1],a=c.a.useState("Debug"),i=Object(l.a)(a,2),b=i[0],p=i[1],O=c.a.useState(null),S=Object(l.a)(O,2),y=S[0],V=S[1],k=c.a.useState(null),M=Object(l.a)(k,2),q=M[0],A=M[1],I=c.a.useState(null),P=Object(l.a)(I,2),Q=P[0],R=P[1],B=c.a.useState(null),L=Object(l.a)(B,2),z=L[0],E=L[1],G=c.a.useState("domino"),J=Object(l.a)(G,2),T=J[0],D=J[1],X=c.a.useRef(null),Y=c.a.useRef(null);Object(h.b)(c.a.useCallback((function(){Y.current&&p(JSON.stringify({buttons:Y.current.inputSource.gamepad.buttons.map((function(e){return e.pressed})),length:Y.current.hoverRayLength,axes:Y.current.inputSource.gamepad.axes,angle:new x.Vector2(Y.current.inputSource.gamepad.axes[2],Y.current.inputSource.gamepad.axes[3]).angle()},null,4))}),[Y,p])),Object(h.b)(c.a.useCallback((function(){X.current&&Y.current&&(X.current.position.copy(Y.current.controller.position),X.current.position.add(g))}),[Y,X]));var _=c.a.useRef(null),N=c.a.useRef(null),H=c.a.useState("initial"),K=Object(l.a)(H,2),U=K[0],W=K[1],Z=c.a.useCallback((function(){W(m.a.uniqueId("dominoRun_"))}),[W]);Object(h.b)(c.a.useCallback((function(){if(Y.current){var e=new x.Vector2(Y.current.inputSource.gamepad.axes[2],Y.current.inputSource.gamepad.axes[3]),t="domino";if(e.length()>.5){var r=["undo","reset"];t=r[Math.floor(e.angle()/(2*Math.PI)*r.length)]}N.current={click:Y.current.inputSource.gamepad.buttons[0].pressed,x:e.x,y:e.y,tool:t},_.current&&(N.current.click&&!_.current.click&&("reset"===t&&Z(),"undo"===t&&o(n.slice(0,-1))),N.current.tool!==!_.current.tool&&D(t)),_.current=Object(s.a)({},N.current)}}),[_,N,Z,D,o,n]));var $=c.a.useCallback((function(e){var t=new x.Vector3(0,0,-1).applyQuaternion(e.controller.controller.quaternion).multiplyScalar(e.controller.hoverRayLength).add(e.controller.controller.position);if(Y.current=e.controller,N.current&&!(new x.Vector2(N.current.x,N.current.y).length()>.5))if(Q){var r=e.controller.inputSource.gamepad.buttons[5].pressed,c=t;E(c);var a=new x.Quaternion;a.multiply((new x.Quaternion).setFromAxisAngle(new x.Vector3(0,-1,0).normalize(),new x.Vector2(c.x-Q.x,c.z-Q.z).angle()-Math.PI/2)),r&&a.multiply((new x.Quaternion).setFromAxisAngle(new x.Vector3(1,0,0),Math.PI/8));var i=(new x.Euler).setFromQuaternion(a).toArray().slice(0,3);V((new x.Quaternion).setFromEuler((new x.Euler).fromArray(i))),A(Q);var s=r?1:2*Q.distanceTo(c),l=m.a.range(s).map((function(e){return{id:m.a.uniqueId("domino_"),position:(new x.Vector3).add(Q).lerp(c,e/s).add(new x.Vector3(0,f[1]/2,0)).toArray(),rotation:i}}));o([].concat(Object(u.a)(e.controller.inputSource.gamepad.buttons[4].pressed?[]:n),Object(u.a)(l))),R(null)}else R(t)}),[V,n,o,Y,R,E,Q,A]);return Object(r.jsxs)(c.a.Fragment,{children:[Object(r.jsx)(j.b,{onSelect:$,children:Object(r.jsx)(v,{color:"#3CCC00"})}),n.map((function(e){return Object(r.jsx)(F,{domino:e},U+e.id)})),Object(r.jsx)(d.a,{ref:X,fontSize:.05,color:"white",anchorX:"center",anchorY:"middle",children:T}),Object(r.jsx)(d.a,{position:[0,3,-7],color:"white",anchorX:"center",anchorY:"middle",children:b}),Q?Object(r.jsx)(w,{position:Q,color:"red"}):null,z?Object(r.jsx)(w,{position:z,color:"blue"}):null,y&&q?Object(r.jsx)(C,{position:q,quaternion:y,color:"green"}):null]})},v=function(e){var t=e.color,n=Object(p.c)((function(){return{mass:0,args:[10,1,10],position:[0,-.5,0]}})),o=Object(l.a)(n,1)[0];return Object(r.jsxs)("mesh",{ref:o,children:[Object(r.jsx)("boxBufferGeometry",{args:[10,1,10]}),Object(r.jsx)("meshStandardMaterial",{color:t})]})},w=function(e){var t=e.color,n=e.position,o=e.quaternion;return Object(r.jsxs)("mesh",{position:n,quaternion:o,children:[Object(r.jsx)("boxBufferGeometry",{args:[.2,.2,.2]}),Object(r.jsx)("meshStandardMaterial",{color:t})]})},y=(new x.Quaternion).setFromAxisAngle(new x.Vector3(1,0,0),Math.PI/2),C=function(e){var t=e.color,n=e.position,o=e.quaternion;return Object(r.jsx)("group",{position:n,quaternion:o,children:Object(r.jsxs)("mesh",{quaternion:y,children:[Object(r.jsx)("coneBufferGeometry",{args:[.1,.3,10]}),Object(r.jsx)("meshStandardMaterial",{color:t})]})})},F=function(e){var t=e.domino,n=Object(p.c)((function(){return{mass:1,material:{friction:.1,restitution:0},args:f,position:t.position,rotation:t.rotation}})),o=Object(l.a)(n,1)[0];return Object(r.jsxs)("mesh",{ref:o,children:[Object(r.jsx)("boxBufferGeometry",{args:f}),Object(r.jsx)("meshStandardMaterial",{color:"#CCCCFF"})]})},V=Object(b.b)(j.c);var k=function(){return Object(r.jsxs)(b.a.Provider,{children:[Object(r.jsxs)(V,{children:[Object(r.jsx)(j.a,{}),Object(r.jsx)("ambientLight",{}),Object(r.jsx)("pointLight",{position:[10,10,10]}),Object(r.jsx)(p.a,{children:Object(r.jsx)(S,{})})]}),Object(r.jsx)(b.a,{})]})},M=function(e){e&&e instanceof Function&&n.e(4).then(n.bind(null,263)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),r(e),o(e),c(e),a(e)}))};i.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(k,{})}),document.getElementById("root")),M()}},[[255,1,2]]]);
//# sourceMappingURL=main.41c0799e.chunk.js.map